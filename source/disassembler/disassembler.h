/* ./disassembler/disassembler.h
 * by kimht
 */
#ifndef _DISASSEMBLER_DISASSEMBLER_H_
#define _DISASSEMBLER_DISASSEMBLER_H_

///////////////////////////////////////////////////////////////////////////////
/// include
///////////////////////////////////////////////////////////////////////////////
#include "../base/base.h"

///////////////////////////////////////////////////////////////////////////////
/// define
///////////////////////////////////////////////////////////////////////////////
#define ARCH_I386       0
#define ARCH_X86_64     1

///////////////////////////////////////////////////////////////////////////////
/// class
///////////////////////////////////////////////////////////////////////////////
class Disassembler {
public:
    static Disassembler *GetInstance();
    bool OpenCS(int arch);
    bool DisassembleCode(const unsigned char *code, string& output);
    void CloseCS();

private:
    static Disassembler *instance;
    csh cs_handle_;

    Disassembler();
};

#endif

